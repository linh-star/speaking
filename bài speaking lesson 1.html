<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BÃ i táº­p Speaking - KhÃ¡nh Linh</title>
<style>
  body {
    font-family: "Segoe UI", sans-serif;
    background-color: #fafafa;
    color: #333;
    line-height: 1.6;
    margin: 30px;
  }
  h1 {
    text-align: center;
    color: #e74c3c;
  }
  h2 {
    color: #2980b9;
    margin-top: 35px;
  }
  h3 {
    color: #16a085;
    margin-top: 25px;
  }
  .question, .section {
    margin-bottom: 25px;
    padding: 10px 15px;
    border-left: 4px solid #2980b9;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 1px 4px rgba(0,0,0,0.08);
  }
  button {
    background-color: #3498db;
    color: white;
    border: none;
    padding: 8px 12px;
    margin-right: 8px;
    border-radius: 6px;
    cursor: pointer;
  }
  button:hover {
    background-color: #2980b9;
  }
  button:disabled {
    background-color: #bdc3c7;
    cursor: not-allowed;
  }
  audio {
    display: block;
    margin-top: 8px;
  }
  .status {
    font-size: 0.9em;
    color: #888;
  }
</style>
</head>
<body>

<h1>BÃ i táº­p Speaking - KhÃ¡nh Linh ğŸ™ï¸</h1>

<div id="questions"></div>

<script>
// ---------------------------
// Part 1 & Part 3: tá»«ng cÃ¢u ghi Ã¢m riÃªng
// ---------------------------
const part1Questions = [
  { section: "Part 1 - Chatting", list: [
    "Do you like chatting with friends?",
    "What do you usually chat about with friends?",
    "Do you prefer to chat with a group of people or with only one friend?",
    "Do you prefer to communicate face-to-face or via social media?",
    "Do you argue with friends?"
  ]},
  { section: "Part 1 - Shoes", list: [
    "Do you like buying shoes? How often?",
    "Have you ever bought shoes online?",
    "How much money do you usually spend on shoes?",
    "Do you prefer shoes that are comfortable or shoes that look nice?",
    "Do you often buy shoes from famous brands?"
  ]},
  { section: "Part 1 - Going Out", list: [
    "Do you bring food or snacks with you when going out?",
    "Do you always take your mobile phone with you when going out?",
    "Do you often bring cash with you?",
    "How often do you use cash?"
  ]},
  { section: "Part 1 - Sharing", list: [
    "Did your parents teach you to share when you were a child?",
    "What kind of things do you like to share with others?",
    "What kind of things are not suitable for sharing?",
    "Who is the first person you would like to share good news with?"
  ]},
  { section: "Part 3 - Lost Your Way", list: [
    "Why do some people get lost more easily than others?",
    "Do you think it is important to be able to read a map?",
    "Do you think it is important to do some preparation before you travel to new places?",
    "How can people find their way when they are lost?",
    "Is a paper map still necessary?",
    "How do people react when they get lost?"
  ]},
  { section: "Part 3 - Traditional Story", list: [
    "What kind of stories do children like?",
    "What are the benefits of bedtime stories for children?",
    "Why do most children like listening to stories before bedtime?",
    "What can children learn from stories?",
    "Do all stories for children have happy endings?",
    "Is a good storyline important for a movie?"
  ]}
];

// ---------------------------
// Part 2: 1 khung ghi Ã¢m cho toÃ n bá»™
// ---------------------------
const part2Sections = [
  { section: "Part 2 - Describe an occasion when you lost your way", list: [
    "Where you were",
    "What happened",
    "How you felt",
    "And explain how you found your way"
  ]},
  { section: "Part 2 - Describe an interesting traditional story", list: [
    "What the story is about",
    "When/how you knew it",
    "Who told you the story",
    "And explain how you felt when you first heard it"
  ]}
];

const container = document.getElementById("questions");
let qIndex = 1;

// ---- Part 1 & Part 3: táº¡o ghi Ã¢m riÃªng tá»«ng cÃ¢u ----
part1Questions.forEach(section => {
  const h2 = document.createElement("h2");
  h2.textContent = section.section;
  container.appendChild(h2);

  section.list.forEach(q => {
    const div = document.createElement("div");
    div.className = "question";
    div.innerHTML = `
      <p><strong>Q${qIndex++}:</strong> ${q}</p>
      <button class="startBtn">ğŸ¤ Ghi Ã¢m</button>
      <button class="stopBtn" disabled>â¹ Dá»«ng</button>
      <button class="deleteBtn" disabled>ğŸ—‘ï¸ XÃ³a</button>
      <audio controls></audio>
      <p class="status"></p>
    `;
    container.appendChild(div);
  });
});

// ---- Part 2: 1 khung ghi Ã¢m cho toÃ n bá»™ pháº§n ----
part2Sections.forEach(section => {
  const h2 = document.createElement("h2");
  h2.textContent = section.section;
  container.appendChild(h2);

  const div = document.createElement("div");
  div.className = "section";
  div.innerHTML = `<ol>` + section.list.map(item => `<li>${item}</li>`).join('') + `</ol>
    <button id="startPart2">ğŸ¤ Ghi Ã¢m Part 2</button>
    <button id="stopPart2" disabled>â¹ Dá»«ng</button>
    <button id="deletePart2" disabled>ğŸ—‘ï¸ XÃ³a</button>
    <audio id="audioPart2" controls></audio>
    <p id="statusPart2" class="status"></p>
  `;
  container.appendChild(div);

  // Ghi Ã¢m Part 2
  let mediaRecorder2;
  let audioChunks2 = [];
  let audioURL2 = null;
  const startBtn2 = div.querySelector("#startPart2");
  const stopBtn2 = div.querySelector("#stopPart2");
  const deleteBtn2 = div.querySelector("#deletePart2");
  const audioEl2 = div.querySelector("#audioPart2");
  const statusEl2 = div.querySelector("#statusPart2");

  startBtn2.onclick = async () => {
    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    mediaRecorder2 = new MediaRecorder(stream);
    audioChunks2 = [];

    mediaRecorder2.ondataavailable = e => audioChunks2.push(e.data);
    mediaRecorder2.onstop = () => {
      const audioBlob = new Blob(audioChunks2, { type: "audio/mp3" });
      audioURL2 = URL.createObjectURL(audioBlob);
      audioEl2.src = audioURL2;
      deleteBtn2.disabled = false;
    };

    mediaRecorder2.start();
    startBtn2.disabled = true;
    stopBtn2.disabled = false;
    statusEl2.textContent = "ğŸ”´ Äang ghi Ã¢m Part 2...";
  };

  stopBtn2.onclick = () => {
    mediaRecorder2.stop();
    startBtn2.disabled = false;
    stopBtn2.disabled = true;
    statusEl2.textContent = "âœ… ÄÃ£ dá»«ng ghi Ã¢m Part 2. Nghe láº¡i bÃªn dÆ°á»›i.";
  };

  deleteBtn2.onclick = () => {
    audioEl2.src = "";
    audioURL2 = null;
    deleteBtn2.disabled = true;
    statusEl2.textContent = "ğŸ—‘ï¸ ÄÃ£ xÃ³a ghi Ã¢m Part 2.";
  };
});

// ---- Táº¡o ghi Ã¢m cho tá»«ng cÃ¢u cá»§a Part 1 & Part 3 ----
container.querySelectorAll(".question").forEach(q => {
  let mediaRecorder;
  let audioChunks = [];
  let audioURL = null;

  const startBtn = q.querySelector(".startBtn");
  const stopBtn = q.querySelector(".stopBtn");
  const deleteBtn = q.querySelector(".deleteBtn");
  const audioEl = q.querySelector("audio");
  const statusEl = q.querySelector(".status");

  startBtn.onclick = async () => {
    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    mediaRecorder = new MediaRecorder(stream);
    audioChunks = [];

    mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
    mediaRecorder.onstop = () => {
      const audioBlob = new Blob(audioChunks, { type: "audio/mp3" });
      audioURL = URL.createObjectURL(audioBlob);
      audioEl.src = audioURL;
      deleteBtn.disabled = false;
    };

    mediaRecorder.start();
    startBtn.disabled = true;
    stopBtn.disabled = false;
    statusEl.textContent = "ğŸ”´ Äang ghi Ã¢m...";
  };

  stopBtn.onclick = () => {
    mediaRecorder.stop();
    startBtn.disabled = false;
    stopBtn.disabled = true;
    statusEl.textContent = "âœ… ÄÃ£ dá»«ng ghi Ã¢m. Nghe láº¡i bÃªn dÆ°á»›i.";
  };

  deleteBtn.onclick = () => {
    audioEl.src = "";
    audioURL = null;
    deleteBtn.disabled = true;
    statusEl.textContent = "ğŸ—‘ï¸ ÄÃ£ xÃ³a ghi Ã¢m.";
  };
});
</script>

</body>
</html>
